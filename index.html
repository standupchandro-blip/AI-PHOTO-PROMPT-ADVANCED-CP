<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompter (Stable)</title>
    
    <!-- Minimal, self-contained CSS for high compatibility and forced layout -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8;
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top for mobile scrolling */
        }
        .container {
            width: 95%; /* Increased width for better use of mobile screen */
            max-width: 440px;
            background: #ffffff;
            margin: 20px 0;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        h1 {
            font-size: 24px;
            color: #1f2937;
            margin-bottom: 4px;
        }
        p {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 15px;
        }
        .progress-bar {
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #3b82f6;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        /* Stable Input/Textarea Styling */
        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            margin-top: 5px; 
            margin-bottom: 10px;
            transition: border-color 0.2s;
        }
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }
        .form-group {
            margin-bottom: 20px;
        }
        /* Stable Button Styling */
        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-blue {
            background-color: #3b82f6;
            color: white;
            flex-grow: 1;
            margin-left: 5px;
        }
        .btn-gray {
            background-color: #e5e7eb;
            color: #374151;
            flex-grow: 1;
            margin-right: 5px;
        }
        .btn-green {
            background-color: #10b981;
            color: white;
            width: 100%;
            margin-top: 15px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
            margin-top: 15px;
        }
        .final-prompt-box {
            background-color: #f9fafb;
            padding: 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            min-height: 100px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .hidden {
            display: none;
        }
        .step-title {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 15px;
        }
        .icon {
            width: 18px;
            height: 18px;
            margin-right: 6px;
        }
        
        /* Minimalist Radio Grid */
        .radio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
            gap: 8px;
            margin-bottom: 10px;
        }
        .radio-grid input[type="radio"] { display: none; }
        .radio-grid label {
            display: block;
            padding: 10px 5px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.1s;
        }
        .radio-grid input[type="radio"]:checked + label {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* Message Box */
        .message-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ef4444; /* Default error color */
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
        }
        
    </style>
</head>
<body>

    <div class="container">
        <h1>Prompter ðŸ§ </h1>
        <p>Build the perfect prompt in 5 simple steps.</p>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
        </div>
        <p id="progressText" style="text-align: right; margin-bottom: 20px;">Step 1 of 5</p>

        <!-- Step Content -->
        <div id="stepContainer">
            <!-- Content will be injected here -->
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button id="backBtn" class="btn btn-gray" onclick="navigateStep(-1)" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="m15 18-6-6 6-6"/></svg>
                Back
            </button>
            <button id="nextBtn" class="btn btn-blue" onclick="navigateStep(1)">
                Next
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="m9 18 6-6-6-6"/></svg>
            </button>
        </div>
    </div>
    
    <!-- Message Box -->
    <div id="messageBox" class="message-box hidden"></div>

    <script>
        // --- State Management and Configuration ---
        const TOTAL_STEPS = 6; 
        let currentStep = 1;
        const promptData = {
            subject: "", action: "",
            medium: "", customStyle: "",
            moodLighting: "", customLighting: "",
            composition: "", customComposition: "",
            finalMods: "8k, highly detailed, smooth, trending on ArtStation"
        };
        let aiEnhancementText = "";

        const STEPS_CONFIG = [
            { id: 1, title: "The Core Idea ðŸŒŸ" },
            { id: 2, title: "Medium & Style ðŸŽ¨" },
            { id: 3, title: "Mood & Lighting ðŸ’¡" },
            { id: 4, title: "Composition ðŸ“" },
            { id: 5, title: "Final Quality Boosters âœ¨" },
            { id: 6, title: "Review & Output ðŸš€" }
        ];

        // --- DOM Elements (Declared early for stability) ---
        const stepContainer = document.getElementById('stepContainer');
        const backBtn = document.getElementById('backBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const messageBox = document.getElementById('messageBox');
        
        // --- UI Helper Functions ---

        function showMessage(text, type = 'error', duration = 3000) {
            messageBox.innerHTML = text;
            
            // Set color based on type
            messageBox.style.backgroundColor = type === 'success' ? '#10b981' : (type === 'info' ? '#3b82f6' : '#ef4444');
            
            messageBox.classList.remove('hidden');

            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, duration);
        }

        // --- Core Logic ---

        function updatePromptData(event) {
            const element = event.target;
            const key = element.id || element.name;
            
            if (element.type === 'radio') {
                promptData[element.name] = element.value.trim();
            } else {
                promptData[key] = element.value.trim();
            }
        }

        function generateBasePrompt() {
            const parts = [
                promptData.subject, promptData.action,
                promptData.medium, promptData.customStyle,
                promptData.moodLighting, promptData.customLighting,
                promptData.composition, promptData.customComposition,
                promptData.finalMods
            ];

            return parts
                .map(part => part.trim())
                .filter(part => part)
                .join(', ');
        }
        
        function getFinalPrompt() {
            const base = generateBasePrompt();
            if (aiEnhancementText.trim()) {
                // Ensure no double commas when joining
                return [base, aiEnhancementText.trim()].filter(t => t).join(', ');
            }
            return base;
        }
        
        function copyPrompt() {
            const promptToCopy = getFinalPrompt();
            if (!promptToCopy) {
                showMessage("Nothing to copy!", 'info');
                return;
            }

            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = promptToCopy;
            document.body.appendChild(tempTextarea);
            tempTextarea.select();
            
            try {
                // Reliable copy method
                document.execCommand('copy');
                showMessage('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/></svg>Prompt Copied!', 'success');
            } catch (err) {
                showMessage("Copy failed. Please manually select the text.", 'error');
            }
            
            document.body.removeChild(tempTextarea);
        }
        
        function restartPrompt() {
            // Reset all values to initial state
            Object.assign(promptData, {
                subject: "", action: "",
                medium: "", customStyle: "",
                moodLighting: "", customLighting: "",
                composition: "", customComposition: "",
                finalMods: "8k, highly detailed, smooth, trending on ArtStation"
            });
            aiEnhancementText = ""; 
            currentStep = 1;
            updateUI();
        }

        // --- Mock AI Enhancement Logic (Instant) ---

        function generateMockEnhancementText(subject) {
            const lowerSubject = subject.toLowerCase();
            
            if (lowerSubject.includes("dragon")) {
                return "Scales are obsidian black, reflecting the dim light of two massive, silver moons. Mist drifts across the ancient, moss-covered crags surrounding its lair. Eyes glow with internal, liquid gold fire. The air is thick with ozone and the scent of sulfur.";
            } else if (lowerSubject.includes("robot") || lowerSubject.includes("mech")) {
                return "The surface is matte charcoal aluminum, heavily weathered with rust streaks and rain erosion. Intricate wiring and hydraulic pistons are visible beneath fractured armor plating. Dust motes float in the beam of a single, powerful headlamp.";
            } else if (lowerSubject.includes("city")) {
                return "The perspective is taken from above, looking down on a labyrinthine network of neon signs and rain-slicked concrete. The atmosphere is dense with fog and artificial light. Extreme architectural detail in the background, with a sense of immense, suffocating scale.";
            } else {
                return "Add extra atmospheric depth with rich textures like polished stone and weathered wood. Include subtle depth of field (DOF) to focus the viewer's eye. The environment is vibrant, featuring saturated colors and soft, inviting light sources.";
            }
        }

        function enhancePromptInstantly() {
            const subject = promptData.subject.trim();
            if (!subject) {
                showMessage("Please enter the main subject in Step 1 before enhancing.", 'error');
                return;
            }

            aiEnhancementText = generateMockEnhancementText(subject);
            showMessage('AI Enhancement added instantly!', 'success');
            
            // Re-render UI to display the new enhanced prompt
            updateUI();
        }

        // --- UI Rendering Functions ---

        function renderStepContent() {
            let html = '';
            const step = STEPS_CONFIG.find(c => c.id === currentStep);

            // Universal title for the current step
            html += `<div class="step-title">${step.title}</div>`;

            switch (currentStep) {
                case 1:
                    html += `
                        <div class="form-group">
                            <label for="subject" style="font-weight: 600;">Who or what is the main subject? <span style="color: #ef4444;">(Required)</span></label>
                            <input type="text" id="subject" value="${promptData.subject}" oninput="updatePromptData(event)" placeholder="e.g., A silver dragon, A cyberpunk samurai">
                        </div>
                        <div class="form-group">
                            <label for="action" style="font-weight: 600;">What is the subject doing/where is it?</label>
                            <input type="text" id="action" value="${promptData.action}" oninput="updatePromptData(event)" placeholder="e.g., soaring over a stormy sea, eating chips in his bedroom">
                        </div>
                    `;
                    break;
                case 2:
                    html += `
                        <p>How do you want the image to look? (Choose one or add your own)</p>
                        <div class="radio-grid">
                            <input type="radio" id="style-photo" name="medium" value="professional photography, detailed, photorealistic" onchange="updatePromptData(event)" ${promptData.medium.includes('photography') ? 'checked' : ''}>
                            <label for="style-photo">Photography</label>
                            
                            <input type="radio" id="style-art" name="medium" value="digital painting, highly detailed, fantasy art" onchange="updatePromptData(event)" ${promptData.medium.includes('painting') ? 'checked' : ''}>
                            <label for="style-art">Digital Painting</label>
                            
                            <input type="radio" id="style-3d" name="medium" value="3D render, Octane render, unreal engine" onchange="updatePromptData(event)" ${promptData.medium.includes('render') ? 'checked' : ''}>
                            <label for="style-3d">3D Render (CGI)</label>
                        </div>
                        <div class="form-group">
                            <label for="customStyle" style="font-weight: 600;">Custom Style/Medium:</label>
                            <textarea id="customStyle" rows="2" oninput="updatePromptData(event)" placeholder="e.g., inspired by Van Gogh, 8-bit pixel art">${promptData.customStyle}</textarea>
                        </div>
                    `;
                    break;
                case 3:
                    html += `
                        <p>Set the atmosphere and light. (Choose one or add your own)</p>
                        <div class="radio-grid">
                            <input type="radio" id="mood-cinematic" name="moodLighting" value="cinematic volumetric lighting, dramatic shadows" onchange="updatePromptData(event)" ${promptData.moodLighting.includes('cinematic') ? 'checked' : ''}>
                            <label for="mood-cinematic">Cinematic/Moody</label>
                            
                            <input type="radio" id="mood-golden" name="moodLighting" value="golden hour, warm, diffused sunlight" onchange="updatePromptData(event)" ${promptData.moodLighting.includes('golden hour') ? 'checked' : ''}>
                            <label for="mood-golden">Golden Hour</label>
                            
                            <input type="radio" id="mood-neon" name="moodLighting" value="neon glow, cyberpunk aesthetic" onchange="updatePromptData(event)" ${promptData.moodLighting.includes('neon') ? 'checked' : ''}>
                            <label for="mood-neon">Neon/Cyberpunk</label>
                        </div>
                        <div class="form-group">
                            <label for="customLighting" style="font-weight: 600;">Custom Lighting/Mood:</label>
                            <textarea id="customLighting" rows="2" oninput="updatePromptData(event)" placeholder="e.g., strong rim light, single overhead lamp">${promptData.customLighting}</textarea>
                        </div>
                    `;
                    break;
                case 4:
                    html += `
                        <p>How should the elements be arranged?</p>
                        <div class="radio-grid">
                            <input type="radio" id="comp-thirds" name="composition" value="rule of thirds, symmetrical composition" onchange="updatePromptData(event)" ${promptData.composition.includes('thirds') ? 'checked' : ''}>
                            <label for="comp-thirds">Symmetrical/Rule of Thirds</label>
                            
                            <input type="radio" id="comp-macro" name="composition" value="macro photograph, extreme close-up" onchange="updatePromptData(event)" ${promptData.composition.includes('macro') ? 'checked' : ''}>
                            <label for="comp-macro">Macro/Close-Up</label>
                            
                            <input type="radio" id="comp-wide" name="composition" value="ultra-wide shot, vast landscape" onchange="updatePromptData(event)" ${promptData.composition.includes('wide shot') ? 'checked' : ''}>
                            <label for="comp-wide">Epic/Wide Shot</label>
                        </div>
                        <div class="form-group">
                            <label for="customComposition" style="font-weight: 600;">Custom Composition/Camera Angle:</label>
                            <textarea id="customComposition" rows="2" oninput="updatePromptData(event)" placeholder="e.g., shot on 50mm lens, low angle, leading lines">${promptData.customComposition}</textarea>
                        </div>
                    `;
                    break;
                case 5:
                    html += `
                        <p>Add technical terms to ensure maximum quality.</p>
                        <div class="form-group">
                            <label for="finalMods" style="font-weight: 600;">Quality Modifiers:</label>
                            <input type="text" id="finalMods" value="${promptData.finalMods}" oninput="updatePromptData(event)" placeholder="e.g., 8k, highly detailed, smooth, trending on ArtStation">
                        </div>
                        <p style="font-size: 0.8em; color: #9ca3af; margin-top: -10px;">The default values are recommended for best results.</p>
                    `;
                    break;
                case 6:
                    const finalPrompt = getFinalPrompt();
                    const basePrompt = generateBasePrompt();

                    html += `
                        <div style="font-weight: 600; color: #3b82f6; margin-bottom: 12px;">Structured Prompt (Base)</div>
                        <p style="font-size: 0.9em; margin-bottom: 15px; color: #4b5563;">${basePrompt || 'The prompt is empty. Go back to Step 1.'}</p>
                        
                        <button id="enhanceBtn" class="btn btn-blue" onclick="enhancePromptInstantly()" style="width: 100%; margin-bottom: 20px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M12 2a10 10 0 0 0-9 15.5L3 21l3.5-1A10 10 0 1 0 12 2z"/></svg>
                            Enhance with AI
                        </button>

                        <div style="font-weight: 600; color: #1f2937; margin-bottom: 12px;">Final Prompt (Ready to Copy)</div>
                        <div class="final-prompt-box" id="finalPromptOutput">
                            ${finalPrompt || 'Start filling out the steps above to see your prompt here.'}
                        </div>

                        <button class="btn btn-green" onclick="copyPrompt()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>
                            Copy Final Prompt
                        </button>
                        
                        <button class="btn btn-gray" onclick="restartPrompt()" style="margin-top: 10px; margin-left: 0;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M21 12a9 9 0 0 0-9-9c-2.484 0-4.73 1.01-6.364 2.636L3 7"/><path d="M3 3v4h4"/><path d="M3 12a9 9 0 0 0 9 9c2.484 0 4.73-1.01 6.364-2.636L21 17"/><path d="M21 21v-4h-4"/></svg>
                            Start Over
                        </button>
                    `;
                    break;
            }
            stepContainer.innerHTML = html;
        }

        function updateNavigation() {
            const isFinalStep = currentStep === TOTAL_STEPS;
            const isFirstStep = currentStep === 1;
            
            // Set button text for the final step transition
            
            nextBtn.innerHTML = isFinalStep ? 
                `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M20 6 9 17l-5-5"/></svg> Finish` :
                `Next <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="m9 18 6-6-6-6"/></svg>`;

            // Update button visibility
            backBtn.disabled = isFirstStep;
            
            // Update progress text
            progressText.textContent = isFinalStep ? "Review & Output" : `Step ${currentStep} of ${TOTAL_STEPS - 1}`;
            
            // Update progress bar
            const progress = (currentStep - 1) / (TOTAL_STEPS - 1);
            progressFill.style.width = `${progress * 100}%`;
        }

        function updateUI() {
            renderStepContent();
            updateNavigation();
        }
        
        function validateStep() {
            // Mandatory check for Step 1: Subject must be filled
            if (currentStep === 1) {
                if (!promptData.subject.trim()) {
                    showMessage("Please enter the main subject to proceed (Step 1).", 'error');
                    return false;
                }
            }
            // No other steps require mandatory input, they are optional choices
            return true;
        }

        function navigateStep(direction) {
            // Validation check only when moving forward
            if (direction > 0 && !validateStep()) {
                return;
            }
            
            // Handle clicking "Finish" button on Step 5 (which is visually 'Next')
            if (currentStep === TOTAL_STEPS - 1 && direction > 0) {
                 currentStep = TOTAL_STEPS;
            } else {
                 currentStep = Math.min(TOTAL_STEPS, Math.max(1, currentStep + direction));
            }
            
            // Update the UI
            updateUI();
            
            // Scroll to the top of the container when navigating steps for better UX
            const container = document.querySelector('.container');
            if(container) container.scrollTop = 0;
        }
        
        // --- Initialization ---
        updateUI();

    </script>
</body>
</html>

